{% extends 'learning/base.html' %}
{% load static %}

{% block title %}Quiz Result - {{ quiz.title }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/quiz-result.css' %}">
{% endblock %}

{% block content %}
<div class="result-page">
    <div class="container">
        <div class="result-container">
            <div class="result-card {% if passed %}passed{% else %}failed{% endif %}">
                <!-- Result Icon with Animation -->
                <div class="result-icon-wrapper">
                    <div class="result-icon-ring {% if passed %}passed{% else %}failed{% endif %}"></div>
                    <div class="result-icon {% if passed %}passed{% else %}failed{% endif %}">
                        {% if passed %}
                        <i class="bi bi-trophy-fill"></i>
                        {% else %}
                        <i class="bi bi-arrow-repeat"></i>
                        {% endif %}
                    </div>
                </div>
                
                <!-- Main Heading -->
                <h1 class="result-title">
                    {% if passed %}
                    <span class="title-icon">ðŸŽ‰</span>Congratulations!
                    {% else %}
                    <span class="title-icon">ðŸ’ª</span>Keep Learning!
                    {% endif %}
                </h1>
                
                <!-- Score Display -->
                <div class="score-wrapper">
                    <div class="score-badge {% if passed %}passed{% else %}failed{% endif %}">
                        <div class="score-display">
                            <span class="score-value">{{ score_percentage|floatformat:1 }}</span>
                            <span class="score-percent">%</span>
                        </div>
                    </div>
                </div>
                
                <!-- Stats Grid -->
                <div class="result-stats">
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="bi bi-star-fill"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-label">Earned Points</div>
                            <div class="stat-value">{{ attempt.earned_points }}</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="bi bi-bullseye"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-label">Total Points</div>
                            <div class="stat-value">{{ attempt.total_points }}</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="bi bi-flag-fill"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-label">Passing Score</div>
                            <div class="stat-value">{{ quiz.passing_score }}%</div>
                        </div>
                    </div>
                </div>
                
                <!-- Result Message -->
                <div class="result-message">
                    {% if passed %}
                    <div class="message-icon success">
                        <i class="bi bi-check-circle-fill"></i>
                    </div>
                    <p class="message-text">Excellent work! You've successfully passed the quiz with a score of <strong>{{ score_percentage|floatformat:1 }}%</strong>.</p>
                    <p class="message-highlight">
                        <i class="bi bi-unlock-fill"></i>
                        <strong>The next module is now unlocked!</strong> Continue your learning journey.
                    </p>
                    {% else %}
                    <div class="message-icon warning">
                        <i class="bi bi-exclamation-triangle-fill"></i>
                    </div>
                    <p class="message-text">You scored <strong>{{ score_percentage|floatformat:1 }}%</strong>, but you need <strong>{{ quiz.passing_score }}%</strong> to pass.</p>
                    <p class="message-highlight">
                        <i class="bi bi-lightbulb-fill"></i>
                        Don't worry! Review the module content and try again. You can retake the quiz anytime.
                    </p>
                    {% endif %}
                </div>
                
                <!-- Action Buttons -->
                <div class="action-buttons">
                    {% if passed %}
                    <a href="{% url 'course_detail' module.course.id %}" class="action-btn btn-primary-action">
                        <span class="btn-icon"><i class="bi bi-arrow-right-circle-fill"></i></span>
                        <span class="btn-text">Continue to Next Module</span>
                    </a>
                    {% else %}
                    <a href="{% url 'take_quiz' module.id %}" class="action-btn btn-primary-action">
                        <span class="btn-icon"><i class="bi bi-arrow-clockwise"></i></span>
                        <span class="btn-text">Retake Quiz</span>
                    </a>
                    {% endif %}
                    <a href="{% url 'module_detail' module.id %}" class="action-btn btn-secondary-action">
                        <span class="btn-icon"><i class="bi bi-book-fill"></i></span>
                        <span class="btn-text">Review Module</span>
                    </a>
                    <a href="{% url 'course_detail' module.course.id %}" class="action-btn btn-secondary-action">
                        <span class="btn-icon"><i class="bi bi-list-ul"></i></span>
                        <span class="btn-text">Back to Course</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        
        // Add entrance animations to stat items
        const statItems = document.querySelectorAll('.stat-item');
        statItems.forEach((item, index) => {
            item.style.opacity = '0';
            item.style.transform = 'translateY(20px)';
            setTimeout(() => {
                item.style.transition = 'all 0.5s cubic-bezier(0.4, 0, 0.2, 1)';
                item.style.opacity = '1';
                item.style.transform = 'translateY(0)';
            }, 500 + (index * 100));
        });
    });
</script>
{% endblock %}

